<!DOCTYPE html>
<html lang="id">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Daftar - RamStore</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
	<style>
		:root{--accent:#ff7a18;--muted:#6b7280}
		body{font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Arial;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}
		.register-container{background:#fff;border-radius:12px;box-shadow:0 20px 60px rgba(0,0,0,0.2);width:100%;max-width:450px;padding:40px}
		.register-container h1{font-size:1.8rem;font-weight:700;margin-bottom:8px;color:#1f2937;text-align:center}
		.register-container p{text-align:center;color:var(--muted);margin-bottom:30px;font-size:0.9rem}
		.form-label{font-weight:600;color:#1f2937;margin-bottom:8px}
		.form-control{border:1px solid #e5e7eb;border-radius:6px;padding:10px 12px;font-size:0.95rem}
		.form-control:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(255,122,24,0.1)}
		.btn-register{background:linear-gradient(90deg,var(--accent),#ff914d);color:#fff;border:none;padding:12px;border-radius:6px;font-weight:600;width:100%;margin-top:20px;cursor:pointer;transition:opacity 0.3s}
		.btn-register:hover{opacity:0.9}
		.alert{border-radius:6px;margin-bottom:20px;font-size:0.9rem}
		.register-link{text-align:center;margin-top:20px;font-size:0.9rem}
		.register-link a{color:var(--accent);text-decoration:none;font-weight:600}
		.register-link a:hover{text-decoration:underline}
		.form-row{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px}
		@media(max-width:576px){
			.form-row{grid-template-columns:1fr}
			.register-container{padding:25px}
		}
	</style>
</head>
<body>
	<div class="register-container">
		<h1><i class="bi bi-shop me-2"></i>RamStore</h1>
		<p>Buat Akun Baru</p>
		
		<div id="alert-msg"></div>
		
		<form id="register-form">
			<div class="mb-3">
				<label for="full_name" class="form-label">Nama Lengkap</label>
				<input type="text" class="form-control" id="full_name" name="full_name" required>
			</div>

			<div class="mb-3">
				<label for="email" class="form-label">Email</label>
				<input type="email" class="form-control" id="email" name="email" required>
			</div>

			<div class="mb-3">
				<label for="username" class="form-label">Username</label>
				<input type="text" class="form-control" id="username" name="username" required>
			</div>

			<div class="mb-3">
				<label for="phone" class="form-label">Nomor Telepon (Opsional)</label>
				<input type="tel" class="form-control" id="phone" name="phone">
			</div>

			<div class="mb-3">
				<label for="address" class="form-label">Alamat (Opsional)</label>
				<textarea class="form-control" id="address" name="address" rows="2"></textarea>
			</div>

			<div class="mb-3">
				<label for="password" class="form-label">Password</label>
				<input type="password" class="form-control" id="password" name="password" required minlength="6">
				<small class="text-muted">Minimal 6 karakter</small>
			</div>

			<div class="mb-3">
				<label for="password_confirm" class="form-label">Konfirmasi Password</label>
				<input type="password" class="form-control" id="password_confirm" name="password_confirm" required minlength="6">
			</div>

			<button type="submit" class="btn-register">
				<i class="bi bi-person-plus me-2"></i>Daftar
			</button>
		</form>
		
		<div class="register-link">
			<p>Sudah punya akun? <a href="login.html">Masuk di sini</a></p>
		</div>
	</div>

	<script>
		const form = document.getElementById('register-form');
		const alertMsg = document.getElementById('alert-msg');

		form.addEventListener('submit', async (e) => {
			e.preventDefault();

			const full_name = document.getElementById('full_name').value.trim();
			const email = document.getElementById('email').value.trim();
			const username = document.getElementById('username').value.trim();
			const phone = document.getElementById('phone').value.trim();
			const address = document.getElementById('address').value.trim();
			const password = document.getElementById('password').value;
			const password_confirm = document.getElementById('password_confirm').value;

			// Validasi
			if (password !== password_confirm) {
				showAlert('Password tidak cocok!', 'danger');
				return;
			}

			try {
				const response = await fetch('api/auth.php?action=register', {
					method: 'POST',
					headers: {'Content-Type': 'application/json'},
					body: JSON.stringify({
						full_name,
						email,
						username,
						phone,
						address,
						password
					})
				});

				const result = await response.json();

				if (response.ok) {
					showAlert('✓ ' + result.message, 'success');
					setTimeout(() => {
						window.location.href = 'login.html';
					}, 2000);
				} else {
					showAlert('✗ ' + result.error, 'danger');
				}
			} catch (error) {
				showAlert('✗ Terjadi kesalahan: ' + error.message, 'danger');
			}
		});

		function showAlert(message, type) {
			alertMsg.innerHTML = `
				<div class="alert alert-${type} alert-dismissible fade show" role="alert">
					${message}
					<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
			`;
		}
	</script>
</body>
</html>